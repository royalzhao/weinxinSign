<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/weui.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/base.css"/>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		
	</head>
	<body>
		<div class="container">
			<div class="head">
				<div class="success-icon">
					<i class="weui-icon-success weui-icon_msg"></i>
				</div>
				<h3>已签到</h3>
			</div>
			
			<div class="caidai">
				<img src="img/caidai3.png" alt="" />
			</div>
			
			<div class="box">
				<div class="xian">
					
				</div>
				<div class="show">
					签到派豆 <span class="num">19</span>
				</div>
				
				<div class="table-head">
					<div class="today">
						<span id="today-year">2017</span>年
						<span id="today-month">11</span>月
					</div>
					<div class="my-jinyan">
						我的派豆：<span class="num">19</span>
					</div>
				</div>
				
				<table class="day"  border="0" cellspacing="0" cellpadding="0">
					
				</table>
			</div>
			
			<div class="signTop">
				<div class="signTop-head">
					<div>签到top10</div>
					<div>
						今日已签到<span id="signNum">7</span>人,我的排名<span id="paiming">5</span>
					</div>
				</div>
				<ul>
					<li class="ul-head">
						<div>用户</div>
						<div>排名</div>
					</li>
					
					<li class="ul-body">
						<div class="userInfo">
							<div class="userFace">
								<img src="img/face2.jpg" alt="头像" title="头像" />
							</div>
							<div class="userName">
								小九妹
							</div>
						</div>
						<div class="level">1</div>
					</li>	
					<!--以下为重复部分-->
					<li class="ul-body">
						<div class="userInfo">
							<div class="userFace">
								<img src="img/face2.jpg" alt="头像" title="头像" />
							</div>
							<div class="userName">
								小九妹
							</div>
						</div>
						<div class="level">1</div>
					</li>		
					<li class="ul-body">
						<div class="userInfo">
							<div class="userFace">
								<img src="img/face2.jpg" alt="头像" title="头像" />
							</div>
							<div class="userName">
								小九妹
							</div>
						</div>
						<div class="level">1</div>
					</li>		
					<li class="ul-body">
						<div class="userInfo">
							<div class="userFace">
								<img src="img/face2.jpg" alt="头像" title="头像" />
							</div>
							<div class="userName">
								小九妹
							</div>
						</div>
						<div class="level">1</div>
					</li>		
					<li class="ul-body">
						<div class="userInfo">
							<div class="userFace">
								<img src="img/face2.jpg" alt="头像" title="头像" />
							</div>
							<div class="userName">
								小九妹
							</div>
						</div>
						<div class="level">1</div>
					</li>		
					<!--重复部分结束-->
				</ul>
			</div>
			
			<div class="panel">
				<div class="panel-head">
					签到规则
				</div>
				<div class="panel-body">
					<p>
						1.每天签到可领取3个派豆;
					</p>
					<p>
						2.每天签到前十名，可额外获取5个派豆;
					</p>
					<p>
						3.连续签到7天可额外获取7个派豆、连续签到15天可额外获取10个派豆、连续签到30天可额外获取20个派豆;
					</p>
					<p>
						4.派豆可以兑换派普肽产品的优惠券以及其他各种礼品，还能用于参与各种兑换活动哦，请大家按时签到，及时领取哦！;
					</p>
				</div>
			</div>
			
			<div class="modal">
				<span class="bg" style="display: none;"></span>
				<div class="modal-success" style="display: none;">
					<i class="weui-icon-success weui-icon_msg"></i>
					<p>签到成功！</p>
					<button class="queren">确认</button>
				</div>
				<div class="modal-error" style="display: none;">
					<i class="weui-icon-warn weui-icon_msg-primary"></i>
					<p>您已成功签到，明天再来吧！</p>
					<button class="queren">确认</button>
				</div>
			</div>
			
			
		</div>
		
		
		
		<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
	    <script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
	    <script src="https://res.wx.qq.com/open/libs/weuijs/1.0.0/weui.min.js"></script>
		<script src="js/index.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/config.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			
			$(function(){
				var a = location.search.split('?');
				var b = a[1].split('=');
				var c = b[1].split('&');
				
				var access_token = getToken('wxe0f9974fb42fff1a','30010a7b6b86f802ed23efa7d716d903',c)
				alert(access_token)
			})
			function getToken(appId,appSecret,code) {
			  let reqUrl = 'https://api.weixin.qq.com/sns/oauth2/access_token?';
			  let params = {
			    appid: appId,
			    secret: appSecret,
			    code: code,
			    grant_type: 'authorization_code'
			  };
			
			  let options = {
			    method: 'get',
			    url: reqUrl+qs.stringify(params)
			  };
			  console.log(options.url);
			  return new Promise((resolve, reject) => {
			    request(options, function (err, res, body) {
			      if (res) {
			        resolve(body);
			      } else {
			        reject(err);
			      }
			    })
			  })
			}
			$.ajax({
				type:"post",
				url:"#",
				dataType:'json',
				success:function(data){
					if(data.state = 'ok'){
						$('.modal .bg').css('display','block');
						$('.modal .modal-success').css('display','block');
						$('.queren').click(function(){
							$('.modal .bg').css('display','none');
							$('.modal .modal-success').css('display','none');
						})
					}else if(data.state = 'error'){
						$('.modal .bg').css('display','block');
						$('.modal .modal-error').css('display','block');
						$('.queren').click(function(){
							$('.modal .bg').css('display','none');
							$('.modal .modal-error').css('display','none');
						})
					}
					
				},
				error:function(){
					//console.log('网络错误')
				}
			});

		</script>
	</body>
</html>
